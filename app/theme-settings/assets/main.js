(()=>{"use strict";class e{static closeNotification(e,t,s){let o=s?s.includes("wdss-modal"):null,n=document.querySelector("html");e.closest(".notification")&&e.closest(".notification").remove(),("prompt"===t||o)&&n.classList.remove("fixed")}static template(t,s,o){let n,c,i=document.querySelector("html");switch(document.onkeydown=t=>"Esc"===t.key||"Escape"===t.key?e.closeNotification(document.querySelector(".modal.notification")):null,s){case"info":default:c="info";break;case"prompt":c="prompt";break;case"confirm":c="confirm"}if(n=`\n\t\t\t\t<div class="modal notification ${c}">\n\t\t\t\t<div class="notification-header">\n\t\t\t\t\t<i class=" times"></i>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-content">\n\t\t\t\t<span>${t}</span>\n\t\t\t\t</div>`,"prompt"===s?(i.classList.add("fixed"),n+='<div class="notification-content-inputs"><input required type="number" min="50" value="50"><button type="button" class="wdss-button">Enter</button></div>'):"confirm"===s&&(n+='<div class="notification-content-inputs"><button class="wdss-button confirm">Yes</button><button class="wdss-button cancel">No</button></div>'),n+="</div>",document.body.insertAdjacentHTML("beforeend",n),document.querySelector(".notification-header i")){let t=document.querySelector(".notification-header i");t.addEventListener("click",(()=>{e.closeNotification(t,s,o)}))}}async confirm(t){e.template(t,"confirm");let s=document.querySelector(".notification-content-inputs"),o=s.querySelector("button.confirm"),n=s.querySelector("button.cancel"),c=new Promise((t=>{o.addEventListener("click",(function(){t(!0),e.closeNotification(s)})),n.addEventListener("click",(function(){t(!1),e.closeNotification(s)}))}));return await c}info(t,s=null){e.template(t,"info",s)}prompt(t,s){e.template(t,"prompt");let o=document.querySelector(".notification-content-inputs"),n=o.querySelector("input"),c=o.querySelector("button");n.value&&c.addEventListener("click",(function(){s(n.value),e.closeNotification(o)}))}}let t=new e;function s(e){e&&document.querySelector(e.selector)&&document.querySelector(e.selector).addEventListener("click",(function(){let t=document.querySelector(e.input),s="";switch(e.input){case"#wdss-jsonld-schema-orgname input":s=wdst_localize.site_name;break;case"#wdss-jsonld-schema-email input":s=wdst_localize.site_email}t.value=s}))}const o=(e,t)=>{setTimeout((function(){e.remove()}),t)};function n(e){const t=document.querySelector(e.toggler),s=t.hasAttribute("checked"),o=document.querySelector(e.target);s&&o.classList.toggle("hidden"),t.addEventListener("click",(()=>{o.classList.toggle("hidden")}))}function c(...e){e.forEach((e=>{Array.from(document.querySelectorAll(e.button)).forEach((s=>{s.addEventListener("click",(()=>{let o=s.closest("div").querySelector(e.target);""!==o.value&&t.confirm("Are you sure?").then((function(e){!0===e&&(o.value="")}))}))}))}))}function i(e){e.setAttribute("checked","checked"),e.checked=!0}const a={toggler:"#wdss-auto-featured-image-condition input",target:"#wdss-featured-images-group"},l={toggler:"#wdss-polylang-meta-data-condition input",target:"#wdss-polylang-meta-data-group"},r={button:"#wdss-featured-images-group button.reset",target:"#wdss-featured-images-group input"},d={button:"#wdss-jsonld-schema-logo button.reset",target:"#wdss-jsonld-schema-logo input"},u={select:".image-chooser.featured button.choose",target:".image-chooser.featured input",is_multiple:!0,title:"Select Featured Images",types:["image"]},m={select:".image-chooser.logo button.choose",target:".image-chooser.logo input",is_multiple:!1,title:"Select Organization Logo",types:["image"]},f={selector:"#wdss-generate-orgname",input:"#wdss-jsonld-schema-orgname input"},p={selector:"#wdss-generate-email",input:"#wdss-jsonld-schema-email input"},y={root_el:"#custom-410s-list-settings",action:"e410_dictionary_update",nonce:"e410-dictionary-nonce",name:"e410_dictionary"},_={root_el:"#post-content-settings",action:"excluded_hosts_dictionary_update",nonce:"excluded-hosts-dictionary-nonce",name:"excluded_hosts_dictionary"},g={query_type:"rest",modal_el:"#exclude-posts-modal",modal_title:"Delete Broken Featured Images",open_modal_btn:"#wdss-remove-broken-featured__choose",fetch_action:"fetch_broken_featured",fetch_nonce_name:"fetch_broken_featured_nonce",fetch_nonce_value:wdst_localize.broken_featured_list_nonce,post_action:"remove_broken_featured",post_nonce_name:"remove_broken_featured_nonce",post_nonce_value:wdst_localize.remove_broken_featured_nonce},h={query_type:"sql",modal_el:"#fix-validation-posts-modal",modal_title:"Fix Empty Posts Content",open_modal_btn:"#wdss-fix-empty-content__choose",fetch_action:"fetch_all_posts",fetch_nonce_name:"empty_posts_list_nonce",fetch_nonce_value:wdst_localize.empty_posts_list_nonce,post_action:"fix_posts_validation_errors",post_nonce_name:"fix-posts-validation-errors-nonce",post_nonce_value:wdst_localize.fix_posts_validation_errors_nonce};function v(e){Array.from(document.querySelectorAll(e.select)).forEach((t=>{t.addEventListener("click",(function(s){let o;s.preventDefault(),e.types||(e.types=["image"]),o=wp.media({title:e.title,multiple:e.is_multiple,library:{orderby:"date",query:!0,post_mime_type:e.types},button:{text:"Select"}}),o.on("close",(function(){let s=t.closest(".image-chooser.featured"),n=t.closest(".image-chooser.logo"),c=o.state().get("selection"),i=new Array,a=new Array,l=0;if(s){c.forEach((function(e){i[l]=e.id,l++}));let t=i.join(",");s.querySelector(e.target).value=t}else if(n){c.forEach((function(e){a[l]=e.attributes.url,l++}));let t=a.join(",");n.querySelector(e.target).value=t}})),o.on("open",(function(){let s=t.closest(".wdss-setting-item.image-chooser"),n=o.state().get("selection");s.querySelector(e.target).value.split(",").forEach((function(e){let t=wp.media.attachment(e);t.fetch(),n.add(t?[t]:[])}))})),o.open()}))}))}let S=new e;function w(e){const t=document.querySelector("html"),s=document.querySelector(e.modal_el);if(s){const o=document.querySelector(e.open_modal_btn),n=s.querySelector(".wdss-modal-header i.times");let c=wdst_localize.total_post_count;function a(){const o=s.querySelector(".wdss-modal-body"),a=s.querySelector(".wdss-modal-informaion-panel"),l=s.querySelector("tbody"),r=s.querySelector(".wdss-button.submit"),d=s.querySelector(".wdss-button.toggle-all"),u=s.querySelector(".wdss-button.get-posts"),m=s.querySelector(".wdss-modal-posts-count");let f=m.querySelector("strong");const p=s.querySelector(".wdss-modal-welcome-msg"),y='<span class="msg error">An Error occured!<br><smallLook in console for more details</small></span>',_=s.querySelector(".wdss-modal-title"),g=e.modal_title;function h(){s.classList.remove("active"),t.classList.remove("fixed"),Array.from(document.querySelectorAll(".notification")).forEach((e=>{e.remove()}))}function v(){return Array.from(document.querySelectorAll(".wdss-table-row.post"))}function w(){v().forEach((e=>{i(e.querySelector('.wdss-table-post__select input[type="checkbox"]'))}))}function b(){!function(){let e=v().length;m.classList.add("active"),f&&(f.innerHTML=e)}();let t=v();t.length>0?(t.forEach((e=>{e.addEventListener("click",(()=>{let t=e.querySelector('.wdss-table-post__select input[type="checkbox"]');var s;t.hasAttribute("checked")?((s=t).removeAttribute("checked"),s.checked=!1):i(t)}))})),u.classList.add("inactive"),r.classList.remove("inactive"),d.classList.remove("inactive"),d.addEventListener("click",w)):(a.insertAdjacentHTML("afterbegin",'<span class="wdss-modal-not-found-msg">No results...</span>'),a.classList.add("active"),d.classList.add("inactive"),r.classList.add("inactive")),r.addEventListener("click",(()=>{console.log("e"),S.confirm("Are you ready to start?").then((t=>{if(!0===t){const t=Array.from(s.querySelectorAll('.wdss-table-post__select input[type="checkbox"]:checked'));let n,c=[];if(!t.length)return void S.info("Please, select the posts which will be proceded");u.classList.remove("inactive"),t.forEach((e=>{c.push(e.value)})),n=c.join(","),console.log(`Selected IDs: ${n}`),r.classList.add("inactive"),d.classList.add("inactive"),m.classList.remove("active"),f.innerHTML="",Array.from(s.querySelectorAll(".wdss-table-row.post")).forEach((e=>{e.parentNode.removeChild(e)}));let i={selected_list:JSON.stringify(n),action:e.post_action};i[e.post_nonce_name]=e.post_nonce_value,u.classList.add("inactive"),o.classList.add("processing"),jQuery.post(ajaxurl,i,"json").done((function(e){a.insertAdjacentHTML("afterbegin",'<span class="msg successful">Completed!<br><small>It can take several minutes while changes are implementing</small></span>'),a.classList.add("active")})).fail((function(e){o.classList.remove("loading"),a.insertAdjacentHTML("afterbegin",y),console.log(e)})).always((function(){o.classList.remove("processing"),u.classList.remove("inactive")}))}}))}),{once:!0})}_.childNodes.length<1&&_.insertAdjacentHTML("afterbegin",g),window.next_fetched_page=Math.ceil(c/30),s.classList.add("active"),t.classList.add("fixed"),n.addEventListener("click",h),document.onkeydown=e=>"Esc"===e.key||"Escape"===e.key?h():null,u.addEventListener("click",(function(){let t=s.querySelector(".msg");t&&t.remove(),u.classList.add("inactive"),p.classList.remove("active"),window.next_fetched_page=Math.ceil(c/30),async function(){if(o.classList.add("loading"),"rest"===e.query_type&&(await function(){let t=[];for(let s=1;s<=window.next_fetched_page;s++)try{t.push(new Promise(((t,n)=>{fetch(document.location.origin+`/wp-json/wp/v2/posts/?per_page=30&page=${s}`).then((e=>e.json())).then((s=>{let n={fetched_list:JSON.stringify(s),action:`${e.fetch_action}`};n[e.fetch_nonce_name]=e.fetch_nonce_value,jQuery.post(ajaxurl,n,"json").done((function(e){t(),l.insertAdjacentHTML("beforeend",e),a.classList.remove("active")})).fail((function(e){o.classList.remove("loading"),a.insertAdjacentHTML("afterbegin",y),console.log(e)}))})).catch((e=>{console.log(e),n()}))})))}catch(e){break}return Promise.allSettled(t)}(window.next_fetched_page),o.classList.remove("loading"),u.classList.add("inactive"),b()),"sql"===e.query_type){let t={action:`${e.fetch_action}`};t[e.fetch_nonce_name]=e.fetch_nonce_value,jQuery.post(ajaxurl,t,"json").done((function(e){l.insertAdjacentHTML("beforeend",e),a.classList.remove("active"),b()})).fail((function(e){a.insertAdjacentHTML("afterbegin",y),console.log(e)})).always((function(){o.classList.remove("loading"),u.classList.add("inactive")}))}}()}))}o&&o.addEventListener("mousedown",a)}}String.prototype.stripSlashes=function(){return this.replace(/\\(.)/gm,"$1")};let b=new e;function L(e){const t=document.querySelector(e.root_el);if(t){const s=t.querySelector(".wdss-button.wdss-table-add"),n=t.querySelector(".save-dictionary"),c=document.querySelector("#wdss-settings-page form"),i=t.querySelector(".wdss-table-handler .wdss-table tbody"),a=t.querySelector('input[type="text"]');let l=jQuery(`${e.root_el} .wdss-table tbody tr`),r=[];function d(){let s=jQuery(`${e.root_el} .wdss-table-handler .wdss-table tbody tr`),c=[];s.each(((e,t)=>{let s=t.querySelector("td:nth-of-type(1)").textContent;c.push(s)}));let i={action:e.action,security:e.nonce};i[e.name]=c,jQuery.ajax({url:wdst_localize.url,type:"post",dataType:"json",data:i,success:function(){let e=t.querySelector(".wdss-table-actions span");e&&e.remove(),n.insertAdjacentHTML("afterend",'<span class="msg successful">Table was updated</span>'),o(t.querySelector("span.msg"),1200),n.classList.add("saved")},fail:function(e){let s=t.querySelector(".wdss-table-actions span");s&&s.remove(),n.insertAdjacentHTML("afterend",'<span class="msg error">Error, look at information in console</span>'),o(t.querySelector("span.msg"),1200),console.log(e)}})}function u(){if(a.value){n.classList.remove("saved");let e=a.value;a.value="",i.insertAdjacentHTML("beforeend",`\n        <tr id="${wdst_localize.wp_rand}">\n          <td>${e}</td>\n          <td class="wdss-table__remove-item"><i class="trash"></i></td>\n        </tr>\n        `)}}function m(){n.classList.remove("saved"),b.confirm("Remove this rule from table?").then((e=>{!0===e&&this.closest("tr").remove()}))}async function f(t){let s,o=jQuery(`${e.root_el} .wdss-table tbody tr`),c=[];jQuery.each(o,(function(){c.push(this.id)})),((e,t)=>{if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(!t.includes(e[s]))return!1;return!0})(r,c)&&(s=!0),s||n.classList.contains("saved")||confirm("All unsaved changes will be lost. Do you want to continue?")||t.preventDefault()}jQuery.each(l,(function(){r.push(this.id)})),n.addEventListener("click",d),s.addEventListener("click",u),jQuery(document).on("click",`${e.root_el} .wdss-table__remove-item i`,m),c.addEventListener("submit",f)}}const q=document.querySelector("#wdss-settings-page");document.addEventListener("DOMContentLoaded",(function(){q&&(document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings) > .wdss-row").forEach((e=>{e.classList.contains("pinned")||e.classList.add("hidden");let t=e.previousElementSibling,s=t.querySelectorAll(".section-toggler");function o(){t.classList.toggle("active"),e.classList.toggle("hidden")}s&&s.forEach((e=>{e.addEventListener("click",o)}))})),function(){const e=document.querySelectorAll(".wdss-section .section-pin"),t=document.querySelectorAll(".wdss-section:not(#wdss-snippets-settings)");function s(){let e=this.closest(".wdss-section-header"),t=e.closest(".wdss-section").getAttribute("id");(JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[]).includes(t)?(this.classList.remove("active"),e.querySelector("h2").classList.remove("pinned"),e.querySelector("i.section-toggler").classList.remove("disabled"),function(e){let t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[],s=t.indexOf(e);-1!==s&&t.splice(s,1),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))}(t)):(this.classList.add("active"),e.classList.add("active"),function(e){let t=JSON.parse(localStorage.getItem("PINNED_WDS_SECTIONS"))||[];t.push(e),localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(t))}(t),e.querySelector("h2").classList.add("pinned"),e.querySelector("i.section-toggler").classList.add("disabled"))}!function(){let e;localStorage.getItem("PINNED_WDS_SECTIONS")?e=localStorage.getItem("PINNED_WDS_SECTIONS"):(e=[],localStorage.setItem("PINNED_WDS_SECTIONS",JSON.stringify(e)));const s=e;t.forEach((e=>{let t=e.getAttribute("id"),o=e.querySelector(".wdss-section-header"),n=o.nextElementSibling;s.includes(t)&&(e.classList.add("pinned"),o.querySelector("i.section-pin").classList.add("active"),o.querySelector("i.section-toggler").classList.add("disabled"),o.classList.add("active"),o.querySelector("h2").classList.add("pinned"),n.classList.remove("hidden"))}))}(),e.forEach((e=>{e.addEventListener("click",s)}))}(),wdst_localize.total_post_count>0&&(n(a),s(f),v(u),c(r),w(g),w(h)),wdst_localize.is_polylang_exists&&wdst_localize.is_polylang_setup&&n(l),L(_),L(y),v(m),c(d),function(){const e=document.querySelector("#wdss-advanced-jsonld-schema-condition input"),t=document.querySelector(".wdss-jsonld-schema-predifined-settings");e.hasAttribute("checked")&&t.classList.add("disabled"),e.addEventListener("click",(function(){t.classList.contains("disabled")?t.classList.remove("disabled"):t.classList.add("disabled")}))}(),s(p),Array.from(document.querySelectorAll('input[type="checkbox"')).forEach((e=>{e.addEventListener("click",(()=>{e.hasAttribute("checked")?(e.removeAttribute("checked"),e.value=0,e.checked=!1):(e.setAttribute("checked","checked"),e.checked=!0,e.value=1)}))})),function(){const e=Array.from(document.querySelectorAll("#wdss-snippets-settings input"));document.querySelector("#wdss-toggle-options").addEventListener("click",(()=>{e[0].hasAttribute("checked")?e.forEach((e=>{e.removeAttribute("checked"),e.checked=!1})):e.forEach((e=>{e.setAttribute("checked","checked"),e.checked=!0}))}))}(),Array.from(document.querySelectorAll(".wdss-setting-item-accordion")).forEach((e=>{let t=e.nextElementSibling;e.addEventListener("click",(()=>{t.classList.contains("active")?(e.classList.remove("opened"),t.classList.remove("active")):(e.classList.add("opened"),t.classList.add("active"))}))})))}))})();